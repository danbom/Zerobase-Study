# CHAPTER5
## _HTTP와 연계하는 웹서버_
> 챕터 이미지

- 💡 가상호스트
- ✨ 중개자
- 📣 캐시
<br>

## 📑 가상호스트

한 개의 서버로 멀티 도메인을 만들 수 있다. 쉽게 말해, 서버 1개로 `가상호스트`를 두어 여러 개의 도메인을 운영할 수 있는 것이다.

```
www.naver.com
www : 호스트(서브도메인)
naver.com : 도메인
```

같은 IP(컴퓨터)로 다른 호스트, 도메인 이름을 가진 웹 사이트를 운영할 수 있다.

이 경우, 멀티 도메인을 가진 서버를 `DNS`에 등록하게 되면 `DNS`가 하나의 동일한 IP를 호출하기 때문에 `https://www.google.com/`, `https://github.com/danbom/` 등 리퀘스트를 했을 때 하나의 웹 서버로 들어오게 된다. 이를 구분하기 위해 호스트명과 도메인명이 완전히 포함된 URI를 리퀘스트 하거나, 호스트 헤더 필드를 지정한 리퀘스트를 해야 한다.

<br>

## 📑 중개자
여기서 말하는 `중개자`란 통신을 중계하는 프로그램을 의미하고 보안, 통신 효율, 감시 등의 목적으로 사용된다. `중개자`의 예시로는 `프록시`, `게이트웨이`, `터널`이 있다.
> 프록시, 게이트웨이, 터널 이미지

<br>

### 📌 Proxy(프록시)
리퀘스트, 리스폰스를 가공해 프록시가 클라이언트와 서버 역할을 대신한다. 네트워크 캐싱, 특정 웹 엑세스 방지(보안), 감시 등을 이유로 사용된다. 예를 들면 회사 내부망에서 특정 웹 사이트의 접근을 막는 등의 역할을 할 수 있다. 2대 이상의 프록시 서버를 경유할 경우 `via` 헤더를 이용해 표시해준다. 프록시의 경우 리퀘스트, 리스폰스 메세지를 가공한다.

많이 사용되는 프록시의 예로는 `NginX`, `Apache`가 있다.
> 프록시 이미지

### 📌 Gateway(게이트웨이)
게이트웨이는 클라이언트와 서버를 중개해주는 중간 경유지 역할을 한다는 점에서 프록시와 비슷하다. 프록시와의 차이점은 리퀘스트, 리스폰스 메세지를 가공하는 프록시와 달리 리퀘스트 및 리스폰스 메세지를 가공하거나 감시하지 않는다. 

게이트웨이는 HTTP 트래픽을 다른 프로토콜로 변환하기 위해 사용하는데 서버에서 FTP로 파일을 통신하고자 하고 클라이언트에서 HTTP로 리퀘스트하고자 할 때, 게이트웨이에서 HTTP를 FTP로 해석해주는 역할을 한다. 이 경우 HTTP/FTP 게이트웨이라고 표시한다.

게이트웨이는 클라이언트와 서버 사이를 안전하게 해 쇼핑몰 신용카드 걸제 시스템과 연계할 때 이용되기도 한다.
> 게이트웨이 이미지

### 📌 Turnnel(터널)
터널은 간단하게 클라이언트와 서버를 다이렉트로 연결시켜준다고 생각하면 되는데 HTTP를 지원하지 않는 애플리케이션(SSL 서버)에 HTTP로 접근하는 방법을 제공한다. 게이트웨이나 프록시를 통해서 TCP 핸드쉐이크가 우선 이뤄져야한다. Connect로 중개자의 관찰 없이 통신하며 터널 자체는 HTTP 리퀘스트를 해석하려 하지 않으며 그대로 다음 서버로 전송한다.
> 터널 이미지

<br>

## 📑 Cache(캐시)
캐시는 프록시 서버와 클라이언트의 로컬 디스크에 보관된 리소스의 사본을 말한다. 캐시를 사용하면 서버에 대한 리소스 요청을 줄일 수 있기 때문에 통신량과 시간을 절약할 수 있다. 캐시의 종류에는 `프록시 서버 캐시`, `클라이언트(브라우저) 캐시`가 있다.

캐시의 과정은 클라이언트에서 프록시 서버로 리퀘스트, 프록시 서버에서 서버로 리퀘스트, 서버로부터의 리스폰스 캐시데이터를 프록시 서버 캐시에 저장, 프록시 서버에서 클라이언트로 리스폰스 전달, 클라이언트 캐시에 저장으로 이루어진다.
> 캐시 이미지

캐시에는 유효 기간이 있는데 서버의 리소스가 갱신되는 경우 또는 캐시의 유효 기간이 만료된 경우 다시 리퀘스트를 보내 캐시 데이터를 갱신해야 한다.
> 캐시 만료 이미지

<br>

<hr>
참조 : 
https://www.youtube.com/watch?v=WP9IndqzYhs&t=1030s
